---
layout : single
title : "[ë¨¸ì‹ ëŸ¬ë‹] Advance day2-1 (ì´ìž¬ì› ê°•ì‚¬ë‹˜)"
categories: MachineLearning
tag: [ì´ì–´ë“œë¦¼ìŠ¤ì¿¨, MachineLearning]
toc: true
author_profile: false
search: true
---

ë¨¸ì‹ ëŸ¬ë‹ì—ì„œëŠ” ë°ì´í„° ë¶„ì„ì´ ê°€ìž¥ ì¤‘ìš”í•©ë‹ˆë‹¤.

---

### ì˜¤ëŠ˜ í•™ìŠµ í•  ë‚´ìš©

ë°ì´í„° ìˆ˜ì§‘ íƒìƒ‰ ì „ì²˜ë¦¬

ì‹œê°„ ë  ë•Œ ìžë£Œ ì—†ì´ ì½”ë”© í•´ë³´ëŠ”ê²Œ ë„ì›€ì´ ë ê²ƒìž…ë‹ˆë‹¤.

### data preprocessing

ë°ì´í„° ì „ì²˜ë¦¬ì— ëŒ€í•´ 5ë‹¨ê³„ë¡œ ë‚˜ëˆ„ì–´ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤.

```
ë°ì´í„° ì „ì²˜ë¦¬(Data Preprocessing)
- data â†’ model â†’ insight
- data preprocessing : data = raw data(ë‚  ê²ƒ), clean, processing
- data â†’ model : model(ì»´í“¨í„°) : ìˆ«ìžê°€ ë¹„ì–´ìžˆìœ¼ë©´ ì•ˆëœë‹¤!
```

```
titanic_dataset

- ì–´ë–¤ feature ë“¤ì´ ì£¼ì–´ì¡Œë‚˜ìš”? columnì´ ìžˆëŠ”ì§€ ì—†ëŠ”ì§€
- ê° feature ê°€ ì˜ë¯¸í•˜ëŠ” ë°”ëŠ” ë¬´ì—‡ì¸ê°€ìš”? columnì´ ì–´ë–¤ ì˜ë¯¸ë¥¼ ê°–ëŠ”ì§€
- train set, test set ì´ ë”°ë¡œ ì£¼ì–´ì¡Œë‚˜ìš”?
- ì–´ë–¤ feature ê°€ categorical ì´ê³  ì–´ë–¤ featureê°€ numerical ì¸ê°€ìš”?
    - featureê°€ ë²”ì£¼í˜•, ìˆ˜ì¹˜í˜•
```

ë¬¸ì œë¥¼ ì–´ë–¤ê²Œ ì •ì˜í•˜ëƒì— ë”°ë¼ yëŠ” ë°”ë€” ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

### Kaggleì˜ Titanic datasetì„ ì˜ˆì‹œë¡œ

### 1. ì–´ë–¤ ë°ì´í„°ê°€ ì£¼ì–´ì¡ŒëŠ”ì§€ í™•ì¸

> ðŸ“ˆNumerical(ìˆ˜ì¹˜í˜•)
> 
- ðŸ‘†âœŒðŸ¤ŸDiscret : sibsp, parch
- ðŸ“ðŸ“ðŸ§­Continuous : age, fare

```python
titanic.describe()
```

describe() í•¨ìˆ˜ë¥¼ í†µí•´ numerical ë°ì´í„°ì— ëŒ€í•´  count, mean, std, min, max ë“±ì„ í™•ì¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

> ðŸ“ŠCategorical(ë²”ì£¼í˜•)
> 
- ðŸŠðŸŽðŸ‡Nominal : survived, sex, embarked
- ðŸ¥‡ðŸ¥ˆðŸ¥‰ordinal : pclass

```python
titanic.describe(include=['o'])
```

categorical ë°ì´í„°ì— ëŒ€í•´ ë¶„ì„í•˜ê³  ì‹¶ë‹¤ë©´ describe í•¨ìˆ˜ì— ì¸ìžê°’ìœ¼ë¡œ include=[â€™oâ€™] ë¥¼ ë„£ì–´ì¤ë‹ˆë‹¤.(ì•ŒíŒŒë²³)

ë°ì´í„°ì˜ í˜•íƒœì™€ ë¶„í¬ë¥¼ ì‚´íŽ´ë³´ëŠ” ê²ƒì´ ì²˜ìŒì—ëŠ” ì‰½ì§€ ì•Šì§€ë§Œ ë‹¤ì–‘í•œ ë°ì´í„°ë¥¼ ë¶„ì„í•´ë³´ë©° ë³´ëŠ” ëˆˆì„ ê¸¸ëŸ¬ì•¼ ìœ ì˜ë¯¸í•œ ê°€ì„¤ì„ ì„¸ìš°ê³  ê²€ì¦ì„ í•  ìˆ˜ ìžˆê²Œë©ë‹ˆë‹¤.

titanic ë°ì´í„°ì—ëŠ” ë¬¸ìžì™€ ìˆ«ìžê°€ í˜¼í•©ë˜ì–´ ì‚¬ìš©ë˜ê³  ìžˆìŠµë‹ˆë‹¤.

ë¬¸ìž ë¶€ë¶„ì€ Categorical í•˜ë©° ìˆ«ìž ë¶€ë¶„ì€ Numerical í•©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ê²½ìš°ì— ë°ì´í„°ë¥¼ **ì „ì²˜ë¦¬** í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.

ex)íŠ¹ì§•ì„ ì°¾ì„ ìˆ˜ ì—†ê³  ê³ ìœ í•˜ê¸° ë•Œë¬¸ì— íŠ¹ë³„ížˆ ê³ ë ¤í•˜ì§€ ì•Šì•„ë„ ëœë‹¤ê³  íŒŒì•…í•˜ì—¬ ticketì´ë¼ëŠ” ì»¬ëŸ¼ì„ ì§€ì› ìŠµë‹ˆë‹¤.

### ë¹„ì–´ìžˆê±°ë‚˜ (NaN) í‹€ë¦° ê°’ì´ ìžˆëŠ” feature ê°€ ìžˆë‹¤ë©´

ê¸°ê³„í•™ìŠµ ëª¨ë¸ì—ì„œ ë¹„ì–´ìžˆëŠ” ê°’ì€ ì¸ì‹ì´ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
ë°ì´í„°ì˜ íŠ¹ì„±ì— ë”°ë¼, ì˜ë„í•˜ëŠ” ë°©í–¥ì— ë”°ë¼ ì—¬ëŸ¬ ì²˜ë¦¬ ë°©ë²•ì´ ìžˆì§€ë§Œ

í†µìƒì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ì„ ì´ìš©í•©ë‹ˆë‹¤.

1. 0 ê°’ìœ¼ë¡œ ëŒ€ì²´ (numericalì˜ ê²½ìš°) , "empty" "null" ë“±ì˜ ê°’ìœ¼ë¡œ ëŒ€ì²´ (categorical ê²½ìš°)
2. ì¤‘ê°„ê°’ìœ¼ë¡œ ëŒ€ì²´ (numericalì˜ ê²½ìš°) , ê°€ìž¥ ë§Žì´ ë“±ìž¥í•˜ëŠ” category ë¡œ ëŒ€ì²´ (categoricalì˜ ê²½ìš°)
3. ìž‘ì€ ìˆ˜ì˜ ê²½ìš°, í•´ë‹¹ instance ë¥¼ ì‚­ì œí•˜ì—¬ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ. ë§Žì´ ë¹„ì–´ìžˆëŠ” ê²½ìš° í•´ë‹¹ feature ë¥¼ ì•„ì˜ˆ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ.

> isna()ë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ì¸¡ê°’ì„ í™•ì¸í•©ë‹ˆë‹¤.
> 

```python
titanic.isna()
```

ê²°ê³¼ì— Trueê°’ì´ ë¹„ì–´ìžˆëŠ” ê°’ìž…ë‹ˆë‹¤.

```python
titanic.insa().sum()
```

ìœ„ ì½”ë“œë¥¼ í†µí•´ ê° ì»¬ëŸ¼ë³„ë¡œ ê²°ì¸¡ì¹˜ê°€ ì–¼ë§ˆë‚˜ ìžˆëŠ”ì§€ ì•Œ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ì˜ë¯¸ì—†ëŠ” ì»¬ëŸ¼ì„ ë‚ ë ¤ì•¼ë§Œí•˜ëŠ” ì´ìœ 

- ë©”ëª¨ë¦¬, íš¨ìœ¨ì„± ì¦ëŒ€
- ì°¨ì›ì˜ ë¬¸ì œ

ë°ì´í„° ì•ˆì—ì„œ ì–´ë–¤ ì»¬ëŸ¼ë“¤ì´ ì¤‘ìš”í•œì§€ ìš°ì„ ìˆœìœ„ë¥¼ ë‘ê³  í•™ìŠµì„ ì‹œí‚¤ëŠ”ê²Œ ì¤‘ìš”í•©ë‹ˆë‹¤.

ë°ì´í„°ë¥¼ ìµœì í™”í•˜ê³  ì •ì œí•˜ë©´ í• ìˆ˜ë¡ ì„±ëŠ¥ì€ ì˜¬ë¼ê°‘ë‹ˆë‹¤.

---

### 2. ê°€ì„¤ê²€ì¦

ë°ì´í„°ë¥¼ ì–´ëŠì •ë„ ì‚´íŽ´ë´¤ë‹¤ë©´ ê°€ì„¤ì„ ì„¸ìš°ê³  ë°ì´í„°ë¥¼ ë” ê¹Šê²Œ ì‚´íŽ´ë³´ë©° ì–´ë–¤ featureë¥¼ í•™ìŠµì— ì ìš©í•  ê²ƒì¸ì§€ íŒë‹¨í•´ì•¼í•©ë‹ˆë‹¤.

---

### 3. Missind data

```python
drop.([ì œê±°í•˜ë ¤ëŠ” ì—´ ì´ë¦„], axis = í–‰-0 ì—´-1, inplace = True)
```

ìœ„ì™€ ê°™ì€ ì½”ë“œë¥¼ í†µí•´ í•„ìš”ê°€ ì—†ë‹¤ê³  íŒë‹¨ë˜ëŠ” ê°’ì„ dropí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```python
df.dropna(how='all') # how='any'
```

ëª¨ë“  ê°’ì´ nanì´ë¼ë©´ ìœ„ ì½”ë“œë¥¼ í†µí•´ ì§€ì›Œì¤ë‹ˆë‹¤.

```python
ë°ì´í„°í”„ë ˆìž„.fillna(0)
```

ë¹„êµì  ë¹„ì–´ìžˆëŠ” ê°’(NaN)ì´ ì ê³  í•´ë‹¹ ë°ì´í„°ê°€ ìœ ì˜ë¯¸í•˜ì—¬ ì´ìš©í• ë§Œí•˜ë‹¤ê³  íŒë‹¨ë˜ëŠ” ê²½ìš° 0ì´ë‚˜ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ëŒ€ì¹˜í•´ì¤ë‹ˆë‹¤.

- ë°ì´í„°ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ê³  ê°€ì •!

> Titanic datasetì—ì„œ â€˜Ageâ€™ì˜ ê²½ìš° .drop()ì„ ì‚¬ìš©í•´ì„œ ë²„ë¦¬ê¸°ì—ëŠ” ë„ˆë¬´ ì¤‘ìš”í•œ ê°’ìž…ë‹ˆë‹¤.
ê·¸ë ‡ë‹¤ê³  ì¼ê´„ì ìœ¼ë¡œ ë¹ˆì¹¸ì— 0 ë“±ì˜ ê°’ì„ ë„£ê¸°ì—ëŠ” ë¶„ì„ì— ë„ì›€ì´ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
ê·¸ëž˜ì„œ ì´ëŸ° ìˆ«ìž ë°ì´í„°ì— ì¼ë°˜ì ìœ¼ë¡œ í‰ê· (mean)ì— ë¶„ì‚°(std) ë§Œí¼ ì°¨ì´ ë‚˜ëŠ” ì‚¬ì´ì˜ ìž„ì˜ê°’ì„ ë„£ì–´ì£¼ê²Œ ë©ë‹ˆë‹¤.
> 

í•˜ì§€ë§Œ ëª¨ë“  ê°’ì„ í‰ê· ìœ¼ë¡œ ëŒ€ì²´í•œë‹¤ë©´ ë¶„ì‚°ì´ ì˜í–¥ì„ ë§Žì´ ë°›ê²Œë˜ë¯€ë¡œ ì•„ëž˜ì™€ ê°™ì€ ìž„ì˜ì˜ ê°’ì„ ë„£ì–´ì¤ë‹ˆë‹¤.

```python
np.std()
np.mean()
np.random.unifrom()
.extend()
```

---

### 4. Feature Engineering

```python
titanic['Name'].str.extract(' ([A-Za-z]+)\.', expand=False)
```

ì •ê·œí‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ì—¬ â€˜Nameâ€™ ì»¬ëŸ¼ì— ëŒ€í•´ ì²˜ë¦¬í•´ì¤ë‹ˆë‹¤.

> ì •ê·œí‘œí˜„ì‹ì´ëž€? ë¬¸ìžì—´ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì˜ í•˜ë‚˜ë¡œ íŠ¹ì •í•œ ì¡°ê±´ì˜ ë¬¸ìžë¥¼ 'ê²€ìƒ‰'í•˜ê±°ë‚˜ 'ì¹˜í™˜'í•˜ëŠ” ê³¼ì •ì„ ë§¤ìš° ê°„íŽ¸í•˜ê²Œ ì²˜ë¦¬ í•  ìˆ˜ ìžˆë„ë¡ í•˜ëŠ” ìˆ˜ë‹¨ìž…ë‹ˆë‹¤.
> 

```python
titanic['age_band'] = pd.cut(titanic['Age'], 5)    
```

pd.cut() ì„ ì‚¬ìš©í•˜ë©´ ì›í•˜ëŠ” ì»¬ëŸ¼ì„ êµ¬ê°„ë³„ë¡œ ë‚˜ëˆŒ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```python
pd.pivot_table(titanic, values='Survived', columns='Title')
```

PivotTableì„ ì‚¬ìš©í•˜ë©´ ìš”ì•½ëœ í†µê³„ëŸ‰ì„ í™•ì¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ pd.cut()ì„ í†µí•´ ë‚˜ëˆˆ ë‚˜ì´ êµ¬ê°„ì— ë”°ë¼ ìƒì¡´ë¥ ì´ ì°¨ì´ë‚˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

---

### 5. ë°ì´í„° ê²€ìˆ˜

```python
titanic.info()
```

ìœ„ ì½”ë“œë¥¼ í†µí•´ ëª¨ë“  ì»¬ëŸ¼ì´ numericalí•œ ê°’ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.

```python
titanic['Fare'] = titanic['Fare'].astype(int)
```

â€˜Fareâ€™ ì»¬ëŸ¼ì´ ì†Œìˆ˜ì  5ìžë¦¬ê¹Œì§€ ì“°ëŠ” float64 í˜•íƒœì˜ ê°’ì´ë¼ ìœ„ ì½”ë“œë¥¼ í†µí•´ intë¡œ ë°”ê¿”ì¤ë‹ˆë‹¤.

```python
titanic['Age'] = titanic['Age'].astype(int)
```

â€˜Ageâ€™ ì»¬ëŸ¼ ë˜í•œ intë¡œ ë°”ê¿”ì¤ë‹ˆë‹¤.

```python
titanic['Title'] = titanic['Title'].replace(['Capt', 'Col', 'Countess', 'Don','Dona', 'Dr', 'Jonkheer', 'Lady','Major', 'Rev', 'Sir'], 'Other')
titanic['Title'] = titanic['Title'].replace('Mlle', 'Miss')
titanic['Title'] = titanic['Title'].replace('Mme', 'Mrs')
titanic['Title'] = titanic['Title'].replace('Ms', 'Miss')
```

ì•„ê¹Œ ì •ê·œì‹ì„ í†µí•´ ì²˜ë¦¬í•´ì¤¬ë˜ â€˜Titleâ€™ ì»¬ëŸ¼ì— ì¤‘ë³µë˜ëŠ” ëœ»ì„ ê°€ì§„ í‘œí˜„ë“¤ì´ ì—¬ëŸ¬ê°€ì§€ë¡œ ë˜ì–´ìžˆì–´ í†µì¼í•´ì¤ë‹ˆë‹¤.

```python
from sklearn.preprocessing import LabelEncoder    # LabelEncoderë¥¼ ë¶ˆëŸ¬ì˜¤ê¸°
encoder = LabelEncoder()      # encoderë¼ëŠ” ë³€ìˆ˜ë¥¼ ì„ ì–¸
encoder.fit(titanic['Title']) # title ì—´ì— ë§žê²Œ ì¸ì½”ë”©
titanic['Title'] = encoder.transform(titanic['Title']) # ì¸ì½”ë”© ê²°ê³¼ë¥¼ ì‹¤ì œ í–‰ì— ì ìš©
titanic.head()
```

ê·¸ëŸ° ë‹¤ìŒ, ì‚¬ì´í‚·ëŸ°ì˜ LabelEncoderë¥¼ í†µí•´ numerical ë°ì´í„°ë¡œ ì¸ì½”ë”©í•´ì¤ë‹ˆë‹¤.

```python
titanic.drop('Name',axis=1,inplace=True)
titanic.head()
```

â€˜Nameâ€™ ì»¬ëŸ¼ì€ êµ³ì´ í•„ìš”í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ dropí•´ì¤ë‹ˆë‹¤.

```python
encoder.inverse_transform([3])
```

inverse transform ì„ ì´ìš©í•˜ë©´ ì—­ìœ¼ë¡œ ì›ëž˜ ë¬¸ìžì—´ ë°ì´í„°ë¥¼ ì•Œ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```python
genders = {"male": 0, "female": 1}
titanic['Sex'] = titanic['Sex'].map(genders)
titanic.head()
```

map() í•¨ìˆ˜ë¥¼ í†µí•´ ì„±ë³„ì •ë³´ë„ numericìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

```python
titanic['Embarked'] = titanic['Embarked'].map( {'S': 0, 'C': 1, 'Q': 2} ).astype(int)
```

â€˜Embarkedâ€™ í•­ëª©ë„ 0ê³¼1,2ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ì´ ë•Œ, ì†Œìˆ«ì ì´ ë‚˜ì˜¤ì§€ ì•Šê²Œ .astype(int)ë¥¼ ì¶”ê°€í•´ì¤ë‹ˆë‹¤.

---

ì´í›„ ê°•ì˜ì—ì„œëŠ” scikit-learn ëª¨ë¸ì„ í†µí•´ ê°„ë‹¨í•œ ì„±ëŠ¥ê²€ì¦ì„ í•´ë³´ì•˜ìœ¼ë‚˜

í•´ë‹¹ ë‚´ìš©ì€ ì°¨í›„ì— ëª¨ë¸ ê´€ë ¨ ë³¸ê°•ì˜ì—ì„œ ì •ë¦¬í•˜ëŠ”ê²Œ ë‚˜ì„ê±° ê°™ì•„ ìƒëžµí•˜ì˜€ìŠµë‹ˆë‹¤.

ë‹¤ë§Œ ê°•ì‚¬ë‹˜ì´ í•˜ì‹  ë§ì”€ì„ ë‚¨ê¹ë‹ˆë‹¤.

> ëª¨ë¸í•™ìŠµì€ í•œë²ˆ í•˜ê³  ëë‚˜ëŠ”ê²Œ ì•„ë‹ˆë¼ ì—¬ëŸ¬ë²ˆ ë°˜ë³µì„ í†µí•´ ë³€í™” ì¶”ì´ë¥¼ ì‚´í”¼ëŠ” ê²ƒìž…ë‹ˆë‹¤. baselineì„ ìž¡ê³  ì‹œìž‘í•´ì•¼í•˜ëŠ”ê²Œ ë§žì§€ë§Œ baselineì„ ìž¡ëŠ”ë° ë„ˆë¬´ ê³µì„ ë“¤ì¼ í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤.
> 

---